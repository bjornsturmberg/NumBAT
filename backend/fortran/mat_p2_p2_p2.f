c
c***********************************************************************
c
c      Compute the integral: m_ijk = Integrate[P(i) * P(j) * P(k), over a triangle]
c
c***********************************************************************
c
      subroutine mat_p2_p2_p2 (mat, det_b)
c
c***********************************************************************
c
      implicit none
      double precision mat(6,6,6), det_b

      double precision dt, factor, factor2
      integer*8 i, j, k

      dt=dabs(det_b)

      mat(1, 1, 1) = 18
      mat(1, 1, 2) = -2
      mat(1, 1, 3) = -2
      mat(1, 1, 4) = 12
      mat(1, 1, 5) = 4
      mat(1, 1, 6) = 12
      mat(1, 2, 1) = -2
      mat(1, 2, 2) = -2
      mat(1, 2, 3) = 1
      mat(1, 2, 4) = -4
      mat(1, 2, 5) = 0
      mat(1, 2, 6) = 0
      mat(1, 3, 1) = -2
      mat(1, 3, 2) = 1
      mat(1, 3, 3) = -2
      mat(1, 3, 4) = 0
      mat(1, 3, 5) = 0
      mat(1, 3, 6) = -4
      mat(1, 4, 1) = 12
      mat(1, 4, 2) = -4
      mat(1, 4, 3) = 0
      mat(1, 4, 4) = 0
      mat(1, 4, 5) = -8
      mat(1, 4, 6) = 0
      mat(1, 5, 1) = 4
      mat(1, 5, 2) = 0
      mat(1, 5, 3) = 0
      mat(1, 5, 4) = -8
      mat(1, 5, 5) = -16
      mat(1, 5, 6) = -8
      mat(1, 6, 1) = 12
      mat(1, 6, 2) = 0
      mat(1, 6, 3) = -4
      mat(1, 6, 4) = 0
      mat(1, 6, 5) = -8
      mat(1, 6, 6) = 0
      mat(2, 1, 1) = -2
      mat(2, 1, 2) = -2
      mat(2, 1, 3) = 1
      mat(2, 1, 4) = -4
      mat(2, 1, 5) = 0
      mat(2, 1, 6) = 0
      mat(2, 2, 1) = -2
      mat(2, 2, 2) = 18
      mat(2, 2, 3) = -2
      mat(2, 2, 4) = 12
      mat(2, 2, 5) = 12
      mat(2, 2, 6) = 4
      mat(2, 3, 1) = 1
      mat(2, 3, 2) = -2
      mat(2, 3, 3) = -2
      mat(2, 3, 4) = 0
      mat(2, 3, 5) = -4
      mat(2, 3, 6) = 0
      mat(2, 4, 1) = -4
      mat(2, 4, 2) = 12
      mat(2, 4, 3) = 0
      mat(2, 4, 4) = 0
      mat(2, 4, 5) = 0
      mat(2, 4, 6) = -8
      mat(2, 5, 1) = 0
      mat(2, 5, 2) = 12
      mat(2, 5, 3) = -4
      mat(2, 5, 4) = 0
      mat(2, 5, 5) = 0
      mat(2, 5, 6) = -8
      mat(2, 6, 1) = 0
      mat(2, 6, 2) = 4
      mat(2, 6, 3) = 0
      mat(2, 6, 4) = -8
      mat(2, 6, 5) = -8
      mat(2, 6, 6) = -16
      mat(3, 1, 1) = -2
      mat(3, 1, 2) = 1
      mat(3, 1, 3) = -2
      mat(3, 1, 4) = 0
      mat(3, 1, 5) = 0
      mat(3, 1, 6) = -4
      mat(3, 2, 1) = 1
      mat(3, 2, 2) = -2
      mat(3, 2, 3) = -2
      mat(3, 2, 4) = 0
      mat(3, 2, 5) = -4
      mat(3, 2, 6) = 0
      mat(3, 3, 1) = -2
      mat(3, 3, 2) = -2
      mat(3, 3, 3) = 18
      mat(3, 3, 4) = 4
      mat(3, 3, 5) = 12
      mat(3, 3, 6) = 12
      mat(3, 4, 1) = 0
      mat(3, 4, 2) = 0
      mat(3, 4, 3) = 4
      mat(3, 4, 4) = -16
      mat(3, 4, 5) = -8
      mat(3, 4, 6) = -8
      mat(3, 5, 1) = 0
      mat(3, 5, 2) = -4
      mat(3, 5, 3) = 12
      mat(3, 5, 4) = -8
      mat(3, 5, 5) = 0
      mat(3, 5, 6) = 0
      mat(3, 6, 1) = -4
      mat(3, 6, 2) = 0
      mat(3, 6, 3) = 12
      mat(3, 6, 4) = -8
      mat(3, 6, 5) = 0
      mat(3, 6, 6) = 0
      mat(4, 1, 1) = 12
      mat(4, 1, 2) = -4
      mat(4, 1, 3) = 0
      mat(4, 1, 4) = 0
      mat(4, 1, 5) = -8
      mat(4, 1, 6) = 0
      mat(4, 2, 1) = -4
      mat(4, 2, 2) = 12
      mat(4, 2, 3) = 0
      mat(4, 2, 4) = 0
      mat(4, 2, 5) = 0
      mat(4, 2, 6) = -8
      mat(4, 3, 1) = 0
      mat(4, 3, 2) = 0
      mat(4, 3, 3) = 4
      mat(4, 3, 4) = -16
      mat(4, 3, 5) = -8
      mat(4, 3, 6) = -8
      mat(4, 4, 1) = 0
      mat(4, 4, 2) = 0
      mat(4, 4, 3) = -16
      mat(4, 4, 4) = 144
      mat(4, 4, 5) = 48
      mat(4, 4, 6) = 48
      mat(4, 5, 1) = -8
      mat(4, 5, 2) = 0
      mat(4, 5, 3) = -8
      mat(4, 5, 4) = 48
      mat(4, 5, 5) = 48
      mat(4, 5, 6) = 32
      mat(4, 6, 1) = 0
      mat(4, 6, 2) = -8
      mat(4, 6, 3) = -8
      mat(4, 6, 4) = 48
      mat(4, 6, 5) = 32
      mat(4, 6, 6) = 48
      mat(5, 1, 1) = 4
      mat(5, 1, 2) = 0
      mat(5, 1, 3) = 0
      mat(5, 1, 4) = -8
      mat(5, 1, 5) = -16
      mat(5, 1, 6) = -8
      mat(5, 2, 1) = 0
      mat(5, 2, 2) = 12
      mat(5, 2, 3) = -4
      mat(5, 2, 4) = 0
      mat(5, 2, 5) = 0
      mat(5, 2, 6) = -8
      mat(5, 3, 1) = 0
      mat(5, 3, 2) = -4
      mat(5, 3, 3) = 12
      mat(5, 3, 4) = -8
      mat(5, 3, 5) = 0
      mat(5, 3, 6) = 0
      mat(5, 4, 1) = -8
      mat(5, 4, 2) = 0
      mat(5, 4, 3) = -8
      mat(5, 4, 4) = 48
      mat(5, 4, 5) = 48
      mat(5, 4, 6) = 32
      mat(5, 5, 1) = -16
      mat(5, 5, 2) = 0
      mat(5, 5, 3) = 0
      mat(5, 5, 4) = 48
      mat(5, 5, 5) = 144
      mat(5, 5, 6) = 48
      mat(5, 6, 1) = -8
      mat(5, 6, 2) = -8
      mat(5, 6, 3) = 0
      mat(5, 6, 4) = 32
      mat(5, 6, 5) = 48
      mat(5, 6, 6) = 48
      mat(6, 1, 1) = 12
      mat(6, 1, 2) = 0
      mat(6, 1, 3) = -4
      mat(6, 1, 4) = 0
      mat(6, 1, 5) = -8
      mat(6, 1, 6) = 0
      mat(6, 2, 1) = 0
      mat(6, 2, 2) = 4
      mat(6, 2, 3) = 0
      mat(6, 2, 4) = -8
      mat(6, 2, 5) = -8
      mat(6, 2, 6) = -16
      mat(6, 3, 1) = -4
      mat(6, 3, 2) = 0
      mat(6, 3, 3) = 12
      mat(6, 3, 4) = -8
      mat(6, 3, 5) = 0
      mat(6, 3, 6) = 0
      mat(6, 4, 1) = 0
      mat(6, 4, 2) = -8
      mat(6, 4, 3) = -8
      mat(6, 4, 4) = 48
      mat(6, 4, 5) = 32
      mat(6, 4, 6) = 48
      mat(6, 5, 1) = -8
      mat(6, 5, 2) = -8
      mat(6, 5, 3) = 0
      mat(6, 5, 4) = 32
      mat(6, 5, 5) = 48
      mat(6, 5, 6) = 48
      mat(6, 6, 1) = 0
      mat(6, 6, 2) = -16
      mat(6, 6, 3) = 0
      mat(6, 6, 4) = 48
      mat(6, 6, 5) = 48
      mat(6, 6, 6) = 144

      factor = 2520
      factor2 = dt / factor
      do k=1,6
        do j=1,6
          do i=1,6
            mat(i,j,k) = mat(i,j,k) * factor2
          enddo
        enddo
      enddo
c
      return
      end


